# =====================================================================
# Configuration file for Intel Core i9-14900K (Raptor Lake Refresh)
#
# This configuration is based on the Nehalem architecture, with values
# adjusted for modern processors using publicly available information.
# Some values are estimated.
# =====================================================================

#include intel_arch

# =====================================================================
# 1. Processor
# Defines the processor model, branch predictor, and tlb model.
# =====================================================================
[general]
total_cores = 24                    # 8 P-Cores and 16 E-Cores

[perf_model/core]
# Hyper-Threading (2 threads per core) only on P-Cores
#logical_cpus = 2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
logical_cpus = 1                    # value for E-Cores
logical_cpus[] = 2,2,2,2,2,2,2,2    # value for P-Cores
# P-Cores: 3.2 GHz, E-Cores: 2.4 GHz
#frequency = 3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4,2.4
frequency = 2.4
frequency[] = 3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2 #...

# Based on P-Cores
#[perf_model/core/interval_timer]
#dispatch_width = 6
#window_size = 512                   # Re-order Buffer (ROB) for Raptor Cove (same as Golden Cove)
#num_outstanding_loadstores = 40     # Load/Store Buffers

[perf_model/core/interval_timer]
dispatch_width = 5
dispatch_width[] = 6,6,6,6,6,6,6,6
# Re-order Buffer (ROB) for Raptor Cove (same as Golden Cove)
window_size = 64
window_size[] = 512,512,512,512,512,512,512,512
# Load/Store Buffers
num_outstanding_loadstores = 20
num_outstanding_loadstores[] = 40,40,40,40,40,40,40,40

# Based on P-Cores
#[perf_model/branch_predictor]
#mispredict_penalty = 12

[perf_model/branch_predictor]
mispredict_penalty = 8
mispredict_penalty[] = 12,12,12,12,12,12,12,12

# TLB values based on P-Cores since this parameter is not individual for each core
[perf_model/tlb]
penalty = 35

[perf_model/itlb]
size = 256
associativity = 8

[perf_model/dtlb]
size = 96
associativity = 12

[perf_model/stlb]
size = 2048
associativity = 16

[power]
technology_node = 10          # "Intel 7" process node (10nn)


# =====================================================================
# 2. Memory Hierarchy (Cache & DRAM)
# Defines all cache levels and the main memory configuration.
# =====================================================================
[perf_model/l1_icache]
cache_size = 32               # 32 KB
associativity = 8
data_access_time = 4
tags_access_time = 1

[perf_model/l1_dcache]
cache_size = 48               # 48 KB
associativity = 12
data_access_time = 4
tags_access_time = 1

[perf_model/l2_cache]
cache_size = 2048             # 2 MB per P-Core
associativity = 16
data_access_time = 13
tags_access_time = 4
writeback_time = 60

[perf_model/l3_cache]
cache_size = 36864            # 36 MB total, shared across P-Cores and E-Cores
associativity = 18            # 18-way (sliced)
data_access_time = 35
tags_access_time = 13
shared_cores = 8

#[perf_model/l1_icache]
## E-Cores have a larger L1i to improve instruction fetch efficiency
#cache_size = 64
#cache_size[] = 32,32,32,32,32,32,32,32
#associativity = 12
#associativity[] = 8,8,8,8,8,8,8,8
#data_access_time = 5
#data_access_time[] = 4,4,4,4,4,4,4,4
#tags_access_time = 1

#[perf_model/l1_dcache]
## E-Cores have a smaller L1d to save power and area
#cache_size = 32
#cache_size[] = 48,48,48,48,48,48,48,48
#associativity = 8
#associativity[] = 12,12,12,12,12,12,12,12
#data_access_time = 4
#tags_access_time = 1

#[perf_model/l2_cache]
## E-Cores share a larger L2 cache within a 4-core cluster
#cache_size = 4096
#cache_size[] = 2048,2048,2048,2048,2048,2048,2048,2048
#associativity = 16
#data_access_time = 18
#data_access_time[] = 13,13,13,13,13,13,13,13
#tags_access_time = 5
#tags_access_time[] = 4,4,4,4,4,4,4,4
#writeback_time = 60
#shared_cores = 4
#shared_cores[] = 1,1,1,1,1,1,1,1

[perf_model/dram_directory]
total_entries = 4718592             # Scaled for 36 MB L3

[perf_model/dram]
num_controllers = -1                # Use distributed DRAM controllers
controllers_interleaving = 24       # Interleave across 24 controller slices
latency = 40                        # Raw latency for DDR5
per_controller_bandwidth = 21.3     # In GB/s. Almost 25% of the theoretical limit of 89.6 GB/s.
chips_per_dimm = 8
dimms_per_controller = 4
burst_length = 16                   # Standard for DDR5


# =====================================================================
# 3. Interconnect Network
# Defines how cores and memory communicate.
# =====================================================================
[network/bus]
# Desktop part, no QPI/UPI. The on-chip ring bus handles interconnect.
bandwidth = 200                     # High value for on-chip Ring Interconnect
